\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[english,russian]{babel}
\usepackage{microtype}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{mathtext}
\usepackage{newfloat}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subfig}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.PNG}
\graphicspath{{./img/}}
\captionsetup[figure]{justification=centering}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}
\DeclareCaptionLabelSeparator{dotseparator}{. }
\captionsetup{
   labelsep=dotseparator
}

\begin{document}

\section{Постановка задачи}

Найти спектр энергий и стационарные волновые функции для сферической потенциальной ямы конечной глубины:
%%
\begin{equation}\label{eq:barrier}
U(r) = \begin{cases} 0,    & r \ge R_0 \\
                     -V_0, & r  <  R_0 \end{cases} \textrm{,}
\end{equation}
%%
Орбитальный момент не обязательно равен $0$.

\section{Физическая модель}

Будем рассматривать финитное движение нерелятивистской квантовой частицы известной массы и энергии в сферически симметричном стационарном потенциале, заданном в виде сферической потенциальной ямы конечной глубины.

\section{Математическая модель}

Стационарное уравнение Шредингера имеет вид:
%%
\begin{equation}\label{eq:schrodinger}
\Delta\psi(\bm{r}) + \frac{2m}{\hbar^2} \left(E - U(r)\right) \psi(\bm{r}) = 0 \textrm{,}
\end{equation}
%%
где $E$ -- энергия частицы, а $U(r)$ согласно задаче задается в виде \autoref{eq:barrier}.

Целесообразно рассматривать решение задачи в сферической системе координат. Оператор Лапласа в ней:
%%
\begin{equation}\label{eq:laplacian}
\Delta = \Delta_r + \frac{1}{r^2} \Delta_{\theta, \varphi} = \frac{1}{r} \frac{\partial^2}{\partial r^2} r + \frac{1}{r^2} \left( \frac{1}{\sin(\theta)} \frac{\partial}{\partial \theta} \sin(\theta) \frac{\partial}{\partial \theta} + \frac{1}{\sin^2(\theta)} \frac{\partial^2}{\partial \varphi^2} \right) \textrm{.}
\end{equation}
%%

Угловая часть $\Delta_{\theta, \varphi}$ оператора Лапласа не зависит от $r$. Известно, что решением задачи Штурма-Лиувилля для $\Delta_{\theta, \varphi}$ являются шаровые функции $Y_{l,m}(\theta,\varphi)$, соответствующие собственным значениям $\lambda = l(l+1)$:
%%
\begin{equation}\label{eq:laplacian_anglepart_eigensystem}
\Delta_{\theta, \varphi} Y_{l,m}(\theta,\varphi) = \lambda Y_{l,m}(\theta,\varphi) \textrm{.}
\end{equation}
%%
В приложении к квантовой теории $l \ge 0$ называется орбитальным квантовым числом, $m \in \left[-l, l\right]$ -- магнитным квантовым числом.

Подставим выражение для оператора Лапласа (\autoref{eq:laplacian}) в уравнение Шредингера (\autoref{eq:schrodinger}):
%%
\begin{equation}
\frac{1}{r} \frac{\partial^2}{\partial r^2}\left(r\psi(\bm{r})\right) + \frac{1}{r^2} \Delta_{\theta,\varphi} \psi(\bm{r}) = - \frac{2m}{\hbar^2} (E - U(r)) \psi(\bm{r}) \textrm{.}
\end{equation}
%%

Для упрощения последующих выкладок и исключения первой производной $\psi'$ целесообразно ввести новую функцию $\hat{\psi} = r \psi$. Тогда уравнение Шредингера примет окончательный вид:
%%
\begin{equation}\label{eq:schrodinger_expanded}
\frac{\partial^2\hat{\psi}(\bm{r})}{\partial r^2} + \frac{1}{r^2} \Delta_{\theta, \varphi} \hat{\psi}(\bm{r}) = - \frac{2m}{\hbar^2} (E - U(r)) \hat{\psi}(\bm{r}) \textrm{.}
\end{equation}
%%

Полученное уравнение будем решать методом разделения переменных. Положим
%%
\begin{equation}\label{eq:wavefunc}
\hat{\psi} = u_n(r) Y_{l,m}(\theta,\varphi) \textrm{.}
\end{equation}
%%
Подстановка этого выражения в \autoref{eq:schrodinger_expanded} дает
%%
\begin{equation}
Y_{l,m} \frac{\partial^2 u_n}{\partial r^2} + \frac{1}{r^2} u_n \Delta_{\theta,\varphi} Y_{l,m} = - \frac{2m}{\hbar^2} (E_n - U(r)) u_n Y_{l,m} \textrm{.}
\end{equation}
%%
Группируя в левой части равенства члены, зависящие от $r$, а в правой -- не зависящие от $r$, получаем, пользуясь \autoref{eq:laplacian_anglepart_eigensystem}, радиальное уравнение Шредингера для функции $u_n(r)$:
%%
\begin{equation}\label{eq:schrodinger_radial}
\frac{d^2 u_n(r)}{d r^2} = - \left(\frac{l(l+1)}{r^2} + \frac{2m}{\hbar^2} (E_n - U(r))\right) u_n(r) \textrm{.}
\end{equation}
%%

Возвращаясь к введенной замене $\hat{\psi} = r \psi$, выпишем разложение $\psi$ на радиальную и угловую составляющие:
%%
\begin{equation}\label{eq:wavefunc_decomp}
\psi(\bm{r}) = \frac{\hat{\psi}(\bm{r})}{r} = \frac{u_n(r)}{r} Y_{l,m}(\theta,\varphi) = w_{n}(r) Y_{l,m}(\theta,\varphi) \textrm{.}
\end{equation}
%%

Нас будет интересовать только радиальная составляющая волновой функции $w_n(r)$, поскольку только она зависит от формы барьера $U(r)$. Сферические же функции известны, находятся аналитически и являются специальными функциями матфизики.

Следует обратить внимание, что точка $r = 0$ для рассматриваемого уравнения (\autoref{eq:schrodinger_radial}) является особой. Из соотношения \autoref{eq:wavefunc_decomp} и требования непрерывности волновой функции всюду в пространстве следует, что $u_n(0) = 0$. Кроме того, всегда справедливо $u_n(\infty) = 0$.

\section{Численная модель}

\subsection{Численный метод}

Для решения задачи воспользуемся методом тригонометрической прогонки. Для чего запишем:
%%
\begin{equation}\label{eq:sweep_trig}\begin{aligned}
u_n(r) &= \rho(r) \cos \phi(r) \\
u_n'(r) &= \rho(r) \sin \phi(r) \textrm{,}
\end{aligned}\end{equation}
%%
где $\rho(r)$ -- радиальная, $\phi(r)$ -- фазовая функция, откуда сразу получаем уравнение связи:
%%
\begin{equation}\label{eq:sweep_trig_rel}
u_n' \cos \phi - u_n \sin \phi = 0 \textrm{.}
\end{equation}
%%
Продифференцируем полученное соотношение по $r$:
%%
\begin{equation}
u_n'' \cos \phi - u_n' \phi' \sin \phi - u_n' \sin \phi - u_n \phi' \cos \phi = 0 \textrm{,}
\end{equation}
%%
подставим $u_n''(r)$ из уравнения Шредингера:
%%
\begin{equation}
- \tilde{E}(r) u_n \cos \phi - u_n' \phi' \sin \phi - u_n' \sin \phi - u_n \phi' \cos \phi = 0 \textrm{,}
\end{equation}
%%
где за $\tilde{E}(r)$ обозначен коэффициент перед $u_n(r)$ в уравнении Шредингера.

Рассматривая полученное выражение совместно с \autoref{eq:sweep_trig_rel} как систему однородных линейных уравнений относительно $u_n(r)$ и $u_n'(r)$, запишем условие наличия у системы нетривиальных решений, т.е. потребуем равенства нулю определителя системы:
%%
\begin{equation}
(\tilde{E}(r) + \phi') \cos^2 \phi + (\phi' + 1) \sin^2 \phi = 0 \textrm{,}
\end{equation}
%%
откуда, окончательно,
%%
\begin{equation}\label{eq:phase_dfunc}
\phi'(r) = - \tilde{E}(r) \cos^2 \phi - \sin^2 \phi \textrm{.}
\end{equation}
%%
Данное уравнение будем решать при начальном условии $\psi(0) = \pi / 2$ (следует из \autoref{eq:sweep_trig}). Стационарные уровни энергии $E_n$ найдутся из условия $u_n(\infty) = 0 \approx u_n(L \gg L_0)$, $L_0$ -- характерный размер системы (ширина барьера), т.е. $\phi(L) = - (2 k + 1) \pi / 2$, $k = 0, 1, 2, \dots$

Волновые функции будем искать следующим образом. Продифференцируем первое уравнение в \autoref{eq:sweep_trig} по $r$, подставим \autoref{eq:phase_dfunc} для $\phi'(r)$, перегруппируем члены, получим:
%%
\begin{equation}\label{eq:rho_dfunc}
\rho'(r) = \frac{1}{2} \rho \sin 2\phi (1 - \tilde{E}(r)) \textrm{.}
\end{equation}
%%
Будем решать это уравнение при начальном условии $\rho(0) = 1$.

Для решения задачи Коши выберем явный метод Рунге-Кутты 4-го порядка.

\subsection{Приведение к безразмерному виду}

В целях борьбы с погрешностями, вносимыми спецификой компьютерных вычислений, проведем обезразмеривание параметров задачи.

Введем новые относительные величины:
%%
\begin{equation}\begin{gathered}\label{eq:relative_vars}
s = \frac{r}{L_0} \textrm{, }
s_0 = \frac{R_0}{L_0} \textrm{, }
e = \frac{2m}{\hbar^2} \frac{E}{E_0} \textrm{, }
v_0 = \frac{2m}{\hbar^2} \frac{V_0}{E_0} \textrm{, } \\
u_n(s) = u_n(r = s s_0) \textrm{,} \\
v(s) = (v_0 / V_0) U(r = s s_0) \textrm{.}
\end{gathered}\end{equation}
%%

В них уравнение Шредингера будет иметь вид:
%%
\begin{equation}
\frac{d^2 u_n(s)}{ds^2} = - \left(\frac{l(l+1)}{s^2} + s_0^2 (e_n - v(s))\right) u_n(s) \textrm{.}
\end{equation}
%%

Уравнение \autoref{eq:phase_dfunc} запишется в виде
%%
\begin{equation}
\frac{d\phi(s)}{ds} = - s_0 \left(\frac{l(l+1)}{s^2 s^2_0} + (e_n - v(s))\right) \cos^2 \phi(s) - s_0 \sin^2 \phi(s) \textrm{,}
\end{equation}
%%
а \autoref{eq:rho_dfunc} -- в виде
%%
\begin{equation}
\frac{d\rho(s)}{ds} = \frac{s_0}{2} \rho \sin(2\phi(s)) \left(1 - \left(\frac{l(l+1)}{s^2 s^2_0} + (e_n - v(s))\right)\right) \textrm{.}
\end{equation}
%%

При моделировании можно принять $E_0 = V_0 = 1$, $L_0 = R_0$.

\section{Результаты и их обсуждение}

\section{Выводы}

\end{document}
